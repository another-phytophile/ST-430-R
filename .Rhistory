Pr(>|t|) < 0.05,
summary(citym_f)$coeff %>% as_tibble() %>% select(-"Std. Error") %>% add_column(
ifelse(
"Pr(>|t|)" < 0.05,
"Reject H0, controlling others this var is related to Y",
"Fail to Reject H0, controlling others this var is not related to Y"
),
"Parameter" = c("Intercept", "X1", "X2", "X3", "X4", "X5", "X6")
) %>% select("Parameter", everything())
summary(citym_f)$coeff %>% as_tibble() %>% select(-"Std. Error") %>% add_column(
ifelse(
as.numeric("Pr(>|t|)") < 0.05,
"Reject H0, controlling others this var is related to Y",
"Fail to Reject H0, controlling others this var is not related to Y"
),
"Parameter" = c("Intercept", "X1", "X2", "X3", "X4", "X5", "X6")
) %>% select("Parameter", everything())
summary(citym_f)$coeff %>% as_tibble() %>% select(-"Std. Error") %>% add_column(
ifelse(
as.numeric("Pr(>|t|)") < 0.05,
"Reject H0, controlling others this var is related to Y",
"Fail to Reject H0, controlling others this var is not related to Y"
),
"Parameter" = c("Intercept", "X1", "X2", "X3", "X4", "X5", "X6")
) %>% select("Parameter", everything())
summary(citym_f)$coeff %>% as_tibble() %>% select(-"Std. Error") %>% add_column(
ifelse(
as.numeric(Pr(>|t|)) < 0.05,
summary(citym_f)$coeff %>% as_tibble() %>% select(-"Std. Error") %>% add_column(
ifelse(
"Pr(>|t|) "< 0.05,
"Reject H0, controlling others this var is related to Y",
"Fail to Reject H0, controlling others this var is not related to Y"
),
"Parameter" = c("Intercept", "X1", "X2", "X3", "X4", "X5", "X6")
) %>% select("Parameter", everything())
summary(citym_f)$coeff %>% as_tibble() %>% select(-"Std. Error") %>% add_column(
ifelse(
`Pr(>|t|)` < 0.05,
"Reject H0, controlling others this var is related to Y",
"Fail to Reject H0, controlling others this var is not related to Y"
),
"Parameter" = c("Intercept", "X1", "X2", "X3", "X4", "X5", "X6")
) %>% select("Parameter", everything())
summary(citym_f)$coeff %>% as_tibble() %>% select(-"Std. Error") %>% add_column(
ifelse(
summary(citym_f)$coeff$`Pr(>|t|)` < 0.05,
"Reject H0, controlling others this var is related to Y",
"Fail to Reject H0, controlling others this var is not related to Y"
),
"Parameter" = c("Intercept", "X1", "X2", "X3", "X4", "X5", "X6")
) %>% select("Parameter", everything())
sumt <- summary(citym_f)$coeff %>% as_tibble()
select(sumt,-"Std. Error") %>% add_column(
ifelse(
`Pr(>|t|)` < 0.05,
"Reject H0, controlling others this var is related to Y",
"Fail to Reject H0, controlling others this var is not related to Y"
),
"Parameter" = c("Intercept", "X1", "X2", "X3", "X4", "X5", "X6")
) %>% select("Parameter", everything())
select(sumt,-"Std. Error") %>% add_column(
ifelse(
sumt$`Pr(>|t|)` < 0.05,
"Reject H0, controlling others this var is related to Y",
"Fail to Reject H0, controlling others this var is not related to Y"
),
"Parameter" = c("Intercept", "X1", "X2", "X3", "X4", "X5", "X6")
) %>% select("Parameter", everything())
sumt <- summary(citym_f)$coeff %>% as_tibble()
sumt
summary(citym_f)$coeff
sumt <- summary(citym_f)$coeff %>% as_tibble()
select(sumt,-"Std. Error") %>% add_column(
ifelse(
sumt$`Pr(>|t|)` < 0.05,
"Reject H0, controlling others this var is related to Y",
"Fail to Reject H0, controlling others this var is not related to Y"
),
"Parameter" = c("Intercept", "X1", "X2", "X3", "X4", "X5", "X6")
) %>% select("Parameter", everything())
sumtfinal <- select(sumt,-"Std. Error") %>% add_column(
ifelse(
sumt$`Pr(>|t|)` < 0.05,
"Reject H0, controlling others this var is related to Y",
"Fail to Reject H0, controlling others this var is not related to Y"
),
"Parameter" = c("Intercept", "X1", "X2", "X3", "X4", "X5", "X6")
) %>% select("Parameter", everything())
sumtfinal
sumt <- summary(citym_f)$coeff %>% as_tibble()
sumtfinal <- select(sumt,-"Std. Error") %>% add_column(
ifelse(
sumt$`Pr(>|t|)` < 0.05,
"Reject H0, controlling others this var is related to Y",
"Fail to Reject H0, controlling others this var is not related to Y"
),
"Parameter" = c("Intercept", "X1", "X2", "X3", "X4", "X5", "X6")
) %>% select("Parameter", everything())
sumtfinal
lm(Y~X2:X6,city)
anova(l2,l1)
l2 <- lm(Y~X2:X6,city)
anova(l2,citym_f)
summary(l2)
anova(l2,citym_f)
anova(citym_f,l2)
l2 <- lm(Y~X2+X3+X4+X5+X6,city)
summary(l2)
anova(citym_f,l2)
anova(l2,citym_f)
anova(citym_f)
0.55467/0.00998
anova(citym_f)
anova(citym_f)
0.55467/0.00998
1-pf(55.57816,1,11)
anova(citym_f)
0.55467/0.00998
1-pf(55.57816,1,11)
qt(5.154750e-02,17)
qt(5.154750e-02,17,lower.tail = FALSE)
qt(2*5.154750e-02,17,lower.tail = FALSE)
1-pt(2.1835227,17)
2*(1-pt(2.1835227,17))
ftest(citym_f,matrix(c(0,1,0,0,0,0,0,0),nrow=1))
ftest(citym_f,matrix(c(0,1,0,0,0,0,0),nrow=1))
ftest(citym_f,matrix(c(0,1,0,0,0,0,0),nrow=1)) %>% str()
sumf <- ftest(citym_f,matrix(c(0,1,0,0,0,0,0),nrow=1))
sumf <- ftest(citym_f,matrix(c(0,1,0,0,0,0,0),nrow=1)) %>% add_row(ftest(citym_f,matrix(c(0,0,1,0,0,0,0),nrow=1)))
sumf <- ftest(citym_f,matrix(c(0,1,0,0,0,0,0),nrow=1)) %>% as_tibble %>% add_row(ftest(citym_f,matrix(c(0,0,1,0,0,0,0),nrow=1)))
sumf <- ftest(citym_f,matrix(c(0,1,0,0,0,0,0),nrow=1)) %>% as_tibble %>% add_row(as_tibble(ftest(citym_f,matrix(c(0,0,1,0,0,0,0),nrow=1))))
sumf <- ftest(citym_f,matrix(c(0,1,0,0,0,0,0),nrow=1)) %>% as_tibble %>% add_row(as_tibble(ftest(citym_f,matrix(c(0,0,1,0,0,0,0),nrow=1))))
sumf
ftest(citym_f,matrix(c(0,1,0,0,0,0,0),nrow=1))
ftest(citym_f,matrix(c(0,1,0,0,0,0,0),nrow=1)) %>% str()
ftest(citym_f,matrix(c(0,1,0,0,0,0,0),nrow=1)) %>% as_tibble %>% pivot_longer()
ftest(citym_f,matrix(c(0,1,0,0,0,0,0),nrow=1)) %>% as_tibble %>% pivot_wider()
ftest(citym_f,matrix(c(0,1,0,0,0,0,0),nrow=1)) %>% as_tibble
smuf <- ftest(citym_f,matrix(c(0,1,0,0,0,0,0),nrow=1)) %>% as_tibble
pivot_wider(smuf)
smuf <- ftest(citym_f,matrix(c(0,1,0,0,0,0,0),nrow=1)) %>% as_tibble %>% t()
smuf
l2 <- lm(Y~X2+X3+X4+X5+X6,city)
sumf <- ftest(citym_f,matrix(c(0,1,0,0,0,0,0),nrow=1)) %>% as_tibble %>% add_row(as_tibble(ftest(citym_f,matrix(c(0,0,1,0,0,0,0),nrow=1))))
ftest(citym_f,matrix(c(0,0,1,0,0,0,0),nrow=1))
ftest(citym_f,matrix(c(0,0,0,1,0,0,0),nrow=1))
ftest(citym_f,matrix(c(0,0,0,0,1,0,0),nrow=1))
ftest(citym_f,matrix(c(0,0,0,0,0,1,0),nrow=1))
ftest(citym_f,matrix(c(0,0,0,0,0,0,1),nrow=1))
sumf
ftest(citym_f,matrix(c(0,1,0,0,0,0,0),nrow=1)) %>% as_tibble %>% pivot_wider()
smuf <- ftest(citym_f,matrix(c(0,1,0,0,0,0,0),nrow=1)) %>% as_tibble %>% t() %>%
add_row(t(as_tibble(ftest(citym_f,matrix(c(0,0,1,0,0,0,0),nrow=1)))))
t(as_tibble(ftest(citym_f,matrix(c(0,0,1,0,0,0,0),nrow=1))))
smuf <- ftest(citym_f,matrix(c(0,1,0,0,0,0,0),nrow=1)) %>% as_tibble %>% t() %>%
add_row(as_tibble(t(ftest(citym_f,matrix(c(0,0,1,0,0,0,0),nrow=1)))))
as_tibble(t(ftest(citym_f,matrix(c(0,0,1,0,0,0,0),nrow=1))))
smuf <- ftest(citym_f,matrix(c(0,1,0,0,0,0,0),nrow=1)) %>% as_tibble %>% t() %>%
bind_rows(smuf,as_tibble(t(ftest(citym_f,matrix(c(0,0,1,0,0,0,0),nrow=1)))))
bind_rows(smuf,as_tibble(t(ftest(citym_f,matrix(c(0,0,1,0,0,0,0),nrow=1)))))
as_tibble(t(ftest(citym_f,matrix(c(1,0,0,0,0,0,0),nrow=1))))
l1 <- as_tibble(t(ftest(citym_f,matrix(c(1,0,0,0,0,0,0),nrow=1))))
l2 <- as_tibble(t(ftest(citym_f,matrix(c(0,0,1,0,0,0,0),nrow=1))))
bind rows(l1,l2)
bind_rows(l1,l2)
bind_rows(l1,l2)
l1 <- as_tibble(t(ftest(citym_f,matrix(c(1,0,0,0,0,0,0),nrow=1))))
l2 <- as_tibble(t(ftest(citym_f,matrix(c(0,0,1,0,0,0,0),nrow=1))))
l3 <- as_tibble(t(ftest(citym_f,matrix(c(0,0,0,1,0,0,0),nrow=1))))
l4 <- as_tibble(t(ftest(citym_f,matrix(c(0,0,0,0,1,0,0),nrow=1))))
l5 <- as_tibble(t(ftest(citym_f,matrix(c(0,0,0,0,0,1,0),nrow=1))))
l6 <- as_tibble(t(ftest(citym_f,matrix(c(0,0,0,0,0,0,1),nrow=1))))
bind_rows(l1:l6)
bind_rows(l1-l6)
bind_rows(l1,l2,l3,l4,l5,l6)
smuf <- bind_rows(l1,l2,l3,l4,l5,l6)
smuf <- bind_rows(l1,l2,l3,l4,l5,l6)
smuf
smuf <- tibble("Parameter"=c("X1","X2","X3","X4","X5","X6"))
smuf
smuf <- tibble("Parameter"=c("X1","X2","X3","X4","X5","X6")) %>%  bind_cols(bind_rows(l1,l2,l3,l4,l5,l6) )
smuf
l1 <- as_tibble(t(ftest(citym_f,matrix(c(1,0,0,0,0,0,0),nrow=1))))
l2 <- as_tibble(t(ftest(citym_f,matrix(c(0,0,1,0,0,0,0),nrow=1))))
l3 <- as_tibble(t(ftest(citym_f,matrix(c(0,0,0,1,0,0,0),nrow=1))))
l4 <- as_tibble(t(ftest(citym_f,matrix(c(0,0,0,0,1,0,0),nrow=1))))
l5 <- as_tibble(t(ftest(citym_f,matrix(c(0,0,0,0,0,1,0),nrow=1))))
l6 <- as_tibble(t(ftest(citym_f,matrix(c(0,0,0,0,0,0,1),nrow=1))))
smuf <- tibble("Parameter"=c("X1","X2","X3","X4","X5","X6")) %>%  bind_cols(bind_rows(l1,l2,l3,l4,l5,l6) )
smuf
matrix(c(0,0,1,0,0,0,0,
0,0,0,0,0,1,0,
0,0,0,0,0,0,1),nrow=3,ncol=7,byrow=TRUE)
matrix(c(0,0,1,0,0,0,0,
0,0,0,0,0,1,0,
0,0,0,0,0,0,1),nrow=3,ncol=7,byrow=TRUE)
tm3 <- matrix(c(0,0,1,0,0,0,0,
0,0,0,0,0,1,0,
0,0,0,0,0,0,1),nrow=3,ncol=7,byrow=TRUE)
ftest(citym_f,tm3)
citym_full <- lm(Y~X1*X2,data=city)
citym_full <- lm(Y~X1*X2,data=city) %>% summary()
citym_full %>% summary()
citym_full <- lm(Y~X1*X2,data=city)
citym_full %>% summary()
citym_full <- lm(Y~X1*X2*X3*X4*X5*X6,data=city)
citym_full %>% summary()
citym_full <- lm(Y~X1*X2*X3*X4*X5*X6,data=city)
citym_full %>% summary()
step(citym_full)
cityrefgull <- regsubsets(citym_f)
cityrefgull <- regsubsets(Y~X1+X2+X3+X4+X5+X6,data=city)
summary(cityrefgull)
cityrefgull <- regsubsets(Y~X1+X2+X3+X4+X5+X6,data=city)
rsum <- summary(cityrefgull)
names(rsum)
rsum$which
par(mfrow = c(2,2))
plot(reg_summary$adjr2, xlab = "Number of Variables", ylab = "Adjusted RSq", type = "l")
par(mfrow = c(2,2))
plot(rsum$adjr2, xlab = "Number of Variables", ylab = "Adjusted RSq", type = "l")
adjr2_max<-which.max(rsum$adjr2)
points(adjr2_max, rsum$adjr2[adjr2_max],col="green",cex = 2, pch = 20)
plot(rsum$cp, xlab = "Number of Variables", ylab = "Cp", type = "l")
cp_min = which.min(rsum$cp) # 7
points(cp_min, rsum$cp[cp_min], col = "red", cex = 2, pch = 20)
plot(rsum$bic, xlab = "Number of Variables", ylab = "BIC", type = "l")
bic_min = which.min(rsum$bic) # 6
points(bic_min, rsum$bic[bic_min], col = "turquoise", cex = 2, pch = 20)
cityrefgull <- regsubsets(Y~X1+X2+X3+X4+X5+X6,data=city)
rsum <- summary(cityrefgull)
names(rsum)
rsum$which
par(mfrow = c(2,2))
plot(rsum$adjr2, xlab = "Number of Variables", ylab = "Adjusted RSq", type = "l")
adjr2_max<-which.max(rsum$adjr2)
points(adjr2_max, rsum$adjr2[adjr2_max],col="green",cex = 2, pch = 20)
plot(rsum$cp, xlab = "Number of Variables", ylab = "Cp", type = "l")
cp_min = which.min(rsum$cp) # 7
points(cp_min, rsum$cp[cp_min], col = "red", cex = 2, pch = 20)
plot(rsum$bic, xlab = "Number of Variables", ylab = "BIC", type = "l")
bic_min = which.min(rsum$bic) # 6
points(bic_min, rsum$bic[bic_min], col = "turquoise", cex = 2, pch = 20)
rsum$which
cityrefgull <- regsubsets(Y~X1+X2+X3+X4+X5+X6,data=city)
rsum <- summary(cityrefgull)
names(rsum)
rsum$which
par(mfrow = c(2,2))
plot(rsum$adjr2, xlab = "Number of Variables", ylab = "Adjusted RSq", type = "l")
adjr2_max<-which.max(rsum$adjr2)
points(adjr2_max, rsum$adjr2[adjr2_max],col="green",cex = 2, pch = 20)
plot(rsum$cp, xlab = "Number of Variables", ylab = "Cp", type = "l")
cp_min = which.min(rsum$cp) # 7
points(cp_min, rsum$cp[cp_min], col = "red", cex = 2, pch = 20)
plot(rsum$bic, xlab = "Number of Variables", ylab = "BIC", type = "l")
bic_min = which.min(rsum$bic) # 6
points(bic_min, rsum$bic[bic_min], col = "turquoise", cex = 2, pch = 20)
cityrefgull2 <- regsubsets(Y~X1+X2+X3+X4+X5+X6+I(X1^2)+I(X2^2)+I(X3^2)+I(X4^2)+I(X5^2)+I(X6^2)+
X1*X2 + X1*X3 + X1*X4 + X1*X5 + X1*X6 +
X2*X3 + X2*X4 + X2*X5 + X2*X6 +
X3*X4 + X3*X5 + X3*X6 +
X4*X5 + X4*X6 +
X5*X6
,data=city)
rsum2 <- summary(cityrefgull2)
names(rsum2)
rsum2$which
par(mfrow = c(2,2))
plot(rsum2$adjr2, xlab = "Number of Variables", ylab = "Adjusted RSq", type = "l")
cityrefgull2 <- regsubsets(Y~X1+X2+X3+X4+X5+X6+I(X1^2)+I(X2^2)+I(X3^2)+I(X4^2)+I(X5^2)+I(X6^2)+
X1*X2 + X1*X3 + X1*X4 + X1*X5 + X1*X6 +
X2*X3 + X2*X4 + X2*X5 + X2*X6 +
X3*X4 + X3*X5 + X3*X6 +
X4*X5 + X4*X6 +
X5*X6
,data=city)
rsum2 <- summary(cityrefgull2)
names(rsum2)
rsum2$which
par(mfrow = c(2,2))
plot(rsum2$adjr2, xlab = "Number of Variables", ylab = "Adjusted RSq", type = "l")
adjr2_max<-which.max(rsum2$adjr2)
points(adjr2_max, rsum2$adjr2[adjr2_max],col="green",cex = 2, pch = 20)
plot(rsum2$cp, xlab = "Number of Variables", ylab = "Cp", type = "l")
par(mfrow = c(2,2))
plot(rsum2$adjr2, xlab = "Number of Variables", ylab = "Adjusted RSq", type = "l")
adjr2_max<-which.max(rsum2$adjr2)
points(adjr2_max, rsum2$adjr2[adjr2_max],col="green",cex = 2, pch = 20)
plot(rsum2$cp, xlab = "Number of Variables", ylab = "Cp", type = "l")
par(mfrow = c(2,2))
cityrefgull2 <- regsubsets(Y~X1+X2+X3+X4+X5+X6+I(X1^2)+I(X2^2)+I(X3^2)+I(X4^2)+I(X5^2)+I(X6^2)+
X1*X2 + X1*X3 + X1*X4 + X1*X5 + X1*X6 +
X2*X3 + X2*X4 + X2*X5 + X2*X6 +
X3*X4 + X3*X5 + X3*X6 +
X4*X5 + X4*X6 +
X5*X6
,data=city)
rsum2 <- summary(cityrefgull2)
names(rsum2)
rsum2$which
par(mfrow = c(2,2))
plot(rsum2$adjr2, xlab = "Number of Variables", ylab = "Adjusted RSq", type = "l")
adjr2_max<-which.max(rsum2$adjr2)
points(adjr2_max, rsum2$adjr2[adjr2_max],col="green",cex = 2, pch = 20)
plot(rsum2$cp, xlab = "Number of Variables", ylab = "Cp", type = "l")
cityrefgull2 <- regsubsets(Y~X1+X2+X3+X4+X5+X6+I(X1^2)+I(X2^2)+I(X3^2)+I(X4^2)+I(X5^2)+I(X6^2)+
X1*X2 + X1*X3 + X1*X4 + X1*X5 + X1*X6 +
X2*X3 + X2*X4 + X2*X5 + X2*X6 +
X3*X4 + X3*X5 + X3*X6 +
X4*X5 + X4*X6 +
X5*X6
,data=city)
rsum2 <- summary(cityrefgull2)
names(rsum2)
rsum2$which
par(mfrow = c(2,2))
plot(rsum2$adjr2, xlab = "Number of Variables", ylab = "Adjusted RSq", type = "l")
adjr2_max<-which.max(rsum2$adjr2)
points(adjr2_max, rsum2$adjr2[adjr2_max],col="green",cex = 2, pch = 20)
# plot(rsum2$cp, xlab = "Number of Variables", ylab = "Cp", type = "l")
# cp_min = which.min(rsum2$cp) # 7
# points(cp_min, rsum2$cp[cp_min], col = "red", cex = 2, pch = 20)
plot(rsum2$bic, xlab = "Number of Variables", ylab = "BIC", type = "l")
bic_min = which.min(rsum2$bic) # 6
points(bic_min, rsum2$bic[bic_min], col = "turquoise", cex = 2, pch = 20)
rsum2$which
cityrefgull2 <- regsubsets(Y~X1+X2+X3+X4+X5+X6+I(X1^2)+I(X2^2)+I(X3^2)+I(X4^2)+I(X5^2)+I(X6^2)+
X1*X2 + X1*X3 + X1*X4 + X1*X5 + X1*X6 +
X2*X3 + X2*X4 + X2*X5 + X2*X6 +
X3*X4 + X3*X5 + X3*X6 +
X4*X5 + X4*X6 +
X5*X6
,data=city)
rsum2 <- summary(cityrefgull2)
names(rsum2)
rsum2$which
par(mfrow = c(2,2))
plot(rsum2$adjr2, xlab = "Number of Variables", ylab = "Adjusted RSq", type = "l")
adjr2_max<-which.max(rsum2$adjr2)
points(adjr2_max, rsum2$adjr2[adjr2_max],col="green",cex = 2, pch = 20)
plot(rsum2$cp, xlab = "Number of Variables", ylab = "Cp", type = "l")
plot(rsum2$cp, xlab = "Number of Variables", ylab = "Cp", type = "l")
rsum2$cp
cityrefgull2 <- regsubsets(Y~X1+X2+X3+X4+X5+X6+I(X1^2)+I(X2^2)+I(X3^2)+I(X4^2)+I(X5^2)+I(X6^2)+
X1*X2 + X1*X3 + X1*X4 + X1*X5 + X1*X6 +
X2*X3 + X2*X4 + X2*X5 + X2*X6 +
X3*X4 + X3*X5 + X3*X6 +
X4*X5 + X4*X6 +
X5*X6
,data=city)
rsum2 <- summary(cityrefgull2)
names(rsum2)
rsum2$which
par(mfrow = c(2,2))
plot(rsum2$adjr2, xlab = "Number of Variables", ylab = "Adjusted RSq", type = "l")
cityrefgull2 <- regsubsets(Y~X1+X2+X3+X4+X5+X6+I(X1^2)+I(X2^2)+I(X3^2)+I(X4^2)+I(X5^2)+I(X6^2)+
X1*X2 + X1*X3 + X1*X4 + X1*X5 + X1*X6 +
X2*X3 + X2*X4 + X2*X5 + X2*X6 +
X3*X4 + X3*X5 + X3*X6 +
X4*X5 + X4*X6 +
X5*X6
,data=city)
rsum2 <- summary(cityrefgull2)
names(rsum2)
rsum2$which
par(mfrow = c(2,2))
plot(rsum2$adjr2, xlab = "Number of Variables", ylab = "Adjusted RSq", type = "l")
adjr2_max<-which.max(rsum2$adjr2)
points(adjr2_max, rsum2$adjr2[adjr2_max],col="green",cex = 2, pch = 20)
# plot(rsum2$cp, xlab = "Number of Variables", ylab = "Cp", type = "l")
# cp_min = which.min(rsum2$cp) # 7
# points(cp_min, rsum2$cp[cp_min], col = "red", cex = 2, pch = 20)
plot(rsum2$bic, xlab = "Number of Variables", ylab = "BIC", type = "l")
bic_min = which.min(rsum2$bic) # 6
points(bic_min, rsum2$bic[bic_min], col = "turquoise", cex = 2, pch = 20)
cityrefgull2 <- regsubsets(Y~X1+X2+X3+X4+X5+X6+I(X1^2)+I(X2^2)+I(X3^2)+I(X4^2)+I(X5^2)+I(X6^2)+
X1*X2 + X1*X3 + X1*X4 + X1*X5 + X1*X6 +
X2*X3 + X2*X4 + X2*X5 + X2*X6 +
X3*X4 + X3*X5 + X3*X6 +
X4*X5 + X4*X6 +
X5*X6
,data=city)
rsum2 <- summary(cityrefgull2)
names(rsum2)
rsum2$which
par(mfrow = c(1,2))
plot(rsum2$adjr2, xlab = "Number of Variables", ylab = "Adjusted RSq", type = "l")
adjr2_max<-which.max(rsum2$adjr2)
points(adjr2_max, rsum2$adjr2[adjr2_max],col="green",cex = 2, pch = 20)
# plot(rsum2$cp, xlab = "Number of Variables", ylab = "Cp", type = "l")
# cp_min = which.min(rsum2$cp) # 7
# points(cp_min, rsum2$cp[cp_min], col = "red", cex = 2, pch = 20)
plot(rsum2$bic, xlab = "Number of Variables", ylab = "BIC", type = "l")
bic_min = which.min(rsum2$bic) # 6
points(bic_min, rsum2$bic[bic_min], col = "turquoise", cex = 2, pch = 20)
rsum2$which
cityrefgull2 <- regsubsets(Y~X1+X2+X3+X4+X5+X6+I(X1^2)+I(X2^2)+I(X3^2)+I(X4^2)+I(X5^2)+I(X6^2)+
X1*X2 + X1*X3 + X1*X4 + X1*X5 + X1*X6 +
X2*X3 + X2*X4 + X2*X5 + X2*X6 +
X3*X4 + X3*X5 + X3*X6 +
X4*X5 + X4*X6 +
X5*X6
,data=city)
rsum2 <- summary(cityrefgull2)
names(rsum2)
rsum2$which
par(mfrow = c(1,2))
plot(rsum2$adjr2, xlab = "Number of Variables", ylab = "Adjusted RSq", type = "l")
adjr2_max<-which.max(rsum2$adjr2)
points(adjr2_max, rsum2$adjr2[adjr2_max],col="green",cex = 2, pch = 20)
# plot(rsum2$cp, xlab = "Number of Variables", ylab = "Cp", type = "l")
# cp_min = which.min(rsum2$cp) # 7
# points(cp_min, rsum2$cp[cp_min], col = "red", cex = 2, pch = 20)
plot(rsum2$bic, xlab = "Number of Variables", ylab = "BIC", type = "l")
bic_min = which.min(rsum2$bic) # 6
points(bic_min, rsum2$bic[bic_min], col = "turquoise", cex = 2, pch = 20)
rsum2$which
cityrefgull2 <- regsubsets(Y~X1+X2+X3+X4+X5+X6+I(X1^2)+I(X2^2)+I(X3^2)+I(X4^2)+I(X5^2)+I(X6^2)+
X1*X2 + X1*X3 + X1*X4 + X1*X5 + X1*X6 +
X2*X3 + X2*X4 + X2*X5 + X2*X6 +
X3*X4 + X3*X5 + X3*X6 +
X4*X5 + X4*X6 +
X5*X6
,data=city)
rsum2 <- summary(cityrefgull2)
names(rsum2)
rsum2$which
par(mfrow = c(1,2))
plot(rsum2$adjr2, xlab = "Number of Variables", ylab = "Adjusted RSq", type = "l")
adjr2_max<-which.max(rsum2$adjr2)
points(adjr2_max, rsum2$adjr2[adjr2_max],col="green",cex = 2, pch = 20)
# plot(rsum2$cp, xlab = "Number of Variables", ylab = "Cp", type = "l")
# cp_min = which.min(rsum2$cp) # 7
# points(cp_min, rsum2$cp[cp_min], col = "red", cex = 2, pch = 20)
plot(rsum2$bic, xlab = "Number of Variables", ylab = "BIC", type = "l")
bic_min = which.min(rsum2$bic) # 6
points(bic_min, rsum2$bic[bic_min], col = "turquoise", cex = 2, pch = 20)
Y = b0 + b1X1 + b3X3 + b4X4
lm1 <- lm(Y~X1+X3+X4,data = city)
lm2 <- lm(Y~X1+X4+I(X1^2) + I(X4^2) + X1*X3 + X1*X4 + X3*X4 + X2*X3,data=city)
PRESS.statistic <- sum( (resid(lm1)/(1-hatvalues(lm1)))^2 )
print(paste("PRESS statistic= ", PRESS.statistic))
PRESS.statistic1 <- sum( (resid(lm1)/(1-hatvalues(lm1)))^2 )
print(paste("PRESS statistic= ", PRESS.statistic1))
PRESS.statistic2 <- sum( (resid(lm2)/(1-hatvalues(lm2)))^2 )
print(paste("PRESS statistic= ", PRESS.statistic2))
lm1 <- lm(Y~X1+X3+X4,data = city)
lm2 <- lm(Y~X1+X4+I(X1^2) + I(X4^2) + X1*X3 + X1*X4 + X3*X4 + X2*X3,data=city)
PRESS.statistic1 <- sum( (resid(lm1)/(1-hatvalues(lm1)))^2 )
print(paste("PRESS statistic= ", PRESS.statistic1))
PRESS.statistic2 <- sum( (resid(lm2)/(1-hatvalues(lm2)))^2 )
print(paste("PRESS statistic= ", PRESS.statistic2))
2.0825933*6.02e23
round(1.253721e+24,24)
abs <- data.frame("conc"=(0:10))
abs
library(leaps)
library(tidyverse)
library(ggpmisc)
library(dplyr)
library(tidyverse)
library(tinytex)
library(usethis)
library(lmtest)
library(car)
library(rsq)
library(leaps)
abs <- data.frame("conc"=(0:10)) %>% add_column("abs"= c(
0,
.1
.2,
abs <- data.frame("conc"=(0:10)) %>% add_column("abs"= c(
0,
.1,
.2,
.33,
.4,
.53,
.63,
.72,
.82,
.92,
1.02
)
)
abs
icannotbeleiveiamdoingthis <- lm(abs~conc)
icannotbeleiveiamdoingthis <- lm(abs~conc,abs)
abs
summary(icannotbeleiveiamdoingthis)
icannotbeleiveiamdoingthis <- lm(conc~abs,abs)
summary(icannotbeleiveiamdoingthis)
predict(icannotbeleiveiamdoingthis,0.65)
test <- data.frame("abs"=c(.65))
predict(icannotbeleiveiamdoingthis,test)
6.314294 / 10^6
(6.314294 / 10^6)*368.38
source("C:/Users/yujer/Documents/ST-430-R/Hw424029.R", echo=TRUE)
library(tidyverse)
library(ggpmisc)
library(dplyr)
library(tidyverse)
library(tinytex)
library(usethis)
library(lmtest)
library(car)
library(rsq)
library(leaps)
read.csv("\Datasets\color.csv")
read.csv("/Datasets/color.csv")
